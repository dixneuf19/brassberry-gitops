kyverno-policies:
  policyExclude:
    disallow-host-path: 
      any:
      # Exception for promtail logging
      - resources:
          kinds:
          - Pod
          namespaces:
          - logging
          selector:
            matchLabels:
              app.kubernetes.io/name: promtail
      # Exception for node-exporter
      - resources:
          kinds:
          - Pod
          namespaces:
          - monitoring
          selector:
            matchLabels:
              app: prometheus-node-exporter
    disallow-host-ports:
      any:
      # Exception for metallb
      - resources:
          kinds:
          - Pod
          namespaces:
          - metallb-system
          selector:
            matchLabels:
              app: metallb
              component: speaker
      # Exception for node-exporter
      - resources:
          kinds:
          - Pod
          namespaces:
          - monitoring
          selector:
            matchLabels:
              app: prometheus-node-exporter
      # Exception for arm-exporter
      - resources:
          kinds:
          - Pod
          namespaces:
          - monitoring
          selector:
            matchLabels:
              k8s-app: arm-exporter
    disallow-capabilities:
      any:
        # Exception for metallb
        - resources:
            kinds:
            - Pod
            namespaces:
            - metallb-system
            selector:
              matchLabels:
                app: metallb
                component: speaker
    disallow-host-namespaces:
      any:
        # Exception for metallb
        - resources:
            kinds:
            - Pod
            namespaces:
            - metallb-system
            selector:
              matchLabels:
                app: metallb
                component: speaker
        # Exception for node-exporter
        - resources:
            kinds:
            - Pod
            namespaces:
            - monitoring
            selector:
              matchLabels:
                app: prometheus-node-exporter
    disallow-privileged-containers:
      any:
        # Exception for arm-exporter
        - resources:
            kinds:
            - Pod
            namespaces:
            - monitoring
            selector:
              matchLabels:
                k8s-app: arm-exporter
